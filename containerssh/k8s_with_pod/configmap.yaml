apiVersion: v1
kind: ConfigMap
metadata:
  name: containerssh-config
  namespace: default
data:
  config.yaml:
    # Основная конфигурация ContainerSSH
    log:
      level: debug
      format: text

    ssh:
      # Прослушивание на стандартном SSH порту
      listen: "0.0.0.0:2222"
      # Путь к хостовым ключам (будем использовать отдельный Secret)
      hostkeys:
        - /etc/containerssh/ssh_host_rsa_key

    auth:
      # Используем статическую авторизацию для демонстрации
      # В продакшене используйте OAuth2, LDAP и т.д.
      password:
        enable: true
        method: "password"
        backend: "dummy"

    backend: "docker"
    docker:
      # Настройки подключения к Docker/Podman socket
      connection:
        host: "unix:///var/run/docker.sock"
        # Для Podman может потребоваться certPath и tlsVerify
      execution:
        mode: "session"
        # Базовый образ для контейнеров
        image: "alpine:latest"
        # Политика удаления контейнеров
        container:
          create:
            disableAutoCreate: false
          remove: true
          stop:
            timeout: 10s
        # Настройки сессии
        session:
          # Команда по умолчанию
          command: ["/bin/sh"]
          # Переменные окружения
          env: {}
          # Рабочий каталог
          workingDir: "/"
          # Настройки терминала
          terminal:
            rows: 80
            columns: 24
